<ion-content class="ion-padding">
  <form [formGroup]="flightForm" (ngSubmit)="onSubmit()">
    <ion-item lines="full">
      <ion-label position="stacked">Flight Number</ion-label>
      <ion-input formControlName="flightNumber" placeholder="e.g. KQ001" uppercase></ion-input>
    </ion-item>
    
    @if (flightForm.get('flightNumber')?.touched && flightForm.get('flightNumber')?.invalid) {
      <ion-text color="danger" class="ion-padding-start">
        <small>Valid Flight Number required (3-10 characters).</small>
      </ion-text>
    }

    <div class="ion-padding-top">
      <ion-button expand="block" type="submit" [disabled]="flightForm.invalid || isLoading">
        @if (isLoading) { <ion-spinner name="crescent"></ion-spinner> }
        @else { Create Flight }
      </ion-button>
      
      <ion-button expand="block" fill="outline" color="medium" (click)="generateFlightNumber()">
        Generate Random ID
      </ion-button>
    </div>
  </form>

  @if (recentFlights.length > 0) {
    <ion-list-header>
      <ion-label>Recently Registered</ion-label>
    </ion-list-header>
    <ion-list>
      @for (f of recentFlights; track f.flightNumber) {
        <ion-item [routerLink]="['/check-in', f.id]">
          <ion-label>
            <h2>{{ f.flightNumber }}</h2>
            <p>Created: {{ f.status }}</p>
          </ion-label>
        </ion-item>
      }
    </ion-list>
  }
</ion-content>