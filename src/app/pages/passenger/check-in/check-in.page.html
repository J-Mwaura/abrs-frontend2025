<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>Check-In: {{ flightId }}</ion-title>
  </ion-toolbar>

  <ion-toolbar>
    <ion-searchbar #seqInput type="number" inputmode="numeric" placeholder="Enter Sequence Number (e.g. 042)"
      [value]="searchQuery" (ionInput)="handleSearch($event)" debounce="0">
    </ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content #mainContent [scrollEvents]="true" (ionScroll)="onContentScroll($event)" class="ion-padding">

  @if (showScrollTopButton) {
    <ion-fab slot="fixed" vertical="bottom" horizontal="end">
      <ion-fab-button color="primary" (click)="scrollToTop()">
        <ion-icon name="arrow-up-outline"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  }

  @if (showScrollButton && !showScrollTopButton) {
    <ion-fab slot="fixed" vertical="bottom" horizontal="end">
      <ion-fab-button color="medium" (click)="scrollToBottom()">
        <ion-icon name="arrow-down-outline"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  }

  <div class="search-results-container">
    <ion-list-header>
      <ion-label>Expected Passengers</ion-label>
    </ion-list-header>

    @for (seq of filteredSequences; track seq.sequenceNumber) {
      <ion-item class="animate__animated animate__fadeIn">
        <ion-label>
          <h2 style="font-weight: bold;">#{{ seq.sequenceNumber }}</h2>
          <p>Status: <ion-text color="warning">{{ seq.status }}</ion-text></p>
        </ion-label>
        <ion-button slot="end" color="success" (click)="performCheckIn(seq)">
          CHECK-IN
        </ion-button>
      </ion-item>
    } @empty {
      <div class="ion-text-center ion-padding empty-state">
        <ion-icon name="search-outline" color="medium" style="font-size: 48px;"></ion-icon>
        <p>No expected passengers match this sequence.</p>
      </div>
    }
  </div>

  <div class="recent-activity ion-margin-top">
    <ion-list-header>
      <ion-label color="medium">Recently Checked-In</ion-label>
    </ion-list-header>

    <ion-list lines="full">
      @for (recent of recentCheckIns; track recent.id) {
        <ion-item color="light">
          <ion-label>
            <h3>#{{ recent.sequenceNumber }}</h3>
          </ion-label>
          <ion-badge slot="end" color="success">SUCCESS</ion-badge>
        </ion-item>
      }
    </ion-list>
  </div>

  <ion-toast [isOpen]="showToast" [message]="toastMessage" [duration]="2000" (didDismiss)="showToast = false"
    position="bottom">
  </ion-toast>

</ion-content>